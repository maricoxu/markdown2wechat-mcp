# æ‰‹ç»˜é£æ ¼åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## âœ… åŠŸèƒ½å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡

æ‰‹ç»˜é£æ ¼è½¬æ¢åŠŸèƒ½å·²å®Œå…¨å®ç°ï¼Œå¯ä»¥å°† Mermaid å›¾è¡¨è½¬æ¢ä¸º Excalidraw é£æ ¼çš„æ‰‹ç»˜æ•ˆæœã€‚

---

## ğŸ¯ åŠŸèƒ½è¯´æ˜

### å®ç°æ–¹å¼
- **æŠ€æœ¯**: Rough.js + SVG + Sharp
- **æµç¨‹**: Mermaid â†’ SVG â†’ æ‰‹ç»˜é£æ ¼ SVG â†’ PNG/JPG
- **æ•ˆæœ**: ç±»ä¼¼ Excalidraw çš„æ‰‹ç»˜é£æ ¼

---

## ğŸ“¦ å·²å®‰è£…çš„ä¾èµ–

```bash
âœ… roughjs       # æ‰‹ç»˜é£æ ¼ç”Ÿæˆåº“
âœ… sharp         # å›¾åƒå¤„ç†åº“ï¼ˆSVGè½¬PNGï¼‰
âœ… jsdom         # SVG DOM è§£æ
```

---

## ğŸš€ ä½¿ç”¨æ–¹å¼

### æ–¹å¼ä¸€ï¼šç¼–ç¨‹è°ƒç”¨ï¼ˆæ¨èï¼‰

```typescript
import { convertMermaid } from "./src/mermaid/renderer.js";

await convertMermaid({
  filePath: "/path/to/file.md",
  handDrawn: {
    enabled: true,
    roughness: 1.5,        // 0-3ï¼Œé»˜è®¤ 1.5
    fillStyle: "hachure",  // hachure | cross-hatch | dots | zigzag | solid
  },
});
```

### æ–¹å¼äºŒï¼šç¯å¢ƒå˜é‡é…ç½®

åœ¨ `.env` æ–‡ä»¶ä¸­è®¾ç½®ï¼š

```env
MERMAID_HAND_DRAWN_ENABLED=true
MERMAID_HAND_DRAWN_ROUGHNESS=1.5
MERMAID_HAND_DRAWN_FILL_STYLE=hachure
```

### æ–¹å¼ä¸‰ï¼šMCP å·¥å…·è°ƒç”¨

```json
{
  "tool": "convert_mermaid",
  "arguments": {
    "filePath": "/path/to/file.md",
    "handDrawn": {
      "enabled": true,
      "roughness": 1.5,
      "fillStyle": "hachure"
    }
  }
}
```

---

## ğŸ¨ å‚æ•°è¯´æ˜

### `enabled` (boolean)
æ˜¯å¦å¯ç”¨æ‰‹ç»˜é£æ ¼
- `true`: å¯ç”¨
- `false`: ç¦ç”¨ï¼ˆé»˜è®¤ï¼‰

### `roughness` (number, 0-3)
æ‰‹ç»˜ç²—ç³™åº¦
- `0.5`: è½»å¾®æ‰‹ç»˜æ„Ÿï¼ˆé€‚åˆæ­£å¼æ–‡æ¡£ï¼‰
- `1.0`: ä¸­ç­‰æ‰‹ç»˜æ„Ÿï¼ˆå¹³è¡¡ç¾è§‚ï¼‰
- `1.5`: æ˜æ˜¾æ‰‹ç»˜æ„Ÿï¼ˆ**æ¨è**ï¼ŒExcalidraw é£æ ¼ï¼‰
- `2.0+`: å¼ºçƒˆæ‰‹ç»˜æ„Ÿï¼ˆåˆ›æ„é£æ ¼ï¼‰

### `fillStyle` (enum)
å¡«å……æ ·å¼
- `hachure`: æ–œçº¿å¡«å……ï¼ˆ**æ¨è**ï¼‰
- `cross-hatch`: äº¤å‰çº¿å¡«å……
- `dots`: ç‚¹çŠ¶å¡«å……
- `zigzag`: é”¯é½¿å¡«å……
- `solid`: å®å¿ƒå¡«å……

---

## ğŸ“Š æµ‹è¯•ç»“æœ

### æµ‹è¯•æ–‡ä»¶
- **æµ‹è¯•æ–‡ä»¶**: `test/test-mermaid.md`
- **åŒ…å«å›¾è¡¨**: 3 ä¸ªï¼ˆæµç¨‹å›¾ã€æ—¶åºå›¾ã€ç±»å›¾ï¼‰

### è½¬æ¢ç»“æœ
```
âœ… æˆåŠŸè½¬æ¢ 3 ä¸ªå›¾è¡¨
ğŸ“ è¾“å‡ºç›®å½•: test/.assets/
ğŸ“ æ–‡ä»¶å¤§å°: çº¦ 6-7KB/å›¾ï¼ˆPNGï¼‰
```

### æ•ˆæœå¯¹æ¯”
- **åŸå›¾**: æ ‡å‡† Mermaid å›¾è¡¨ï¼ˆå¹³æ»‘çº¿æ¡ï¼‰
- **æ‰‹ç»˜é£æ ¼**: æŠ–åŠ¨çº¿æ¡ã€ä¸è§„åˆ™è¾¹ç¼˜ï¼ˆç±»ä¼¼ Excalidrawï¼‰

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### é€‚åˆåœºæ™¯
- âœ… åˆ›æ„æ–‡æ¡£
- âœ… æ•™å­¦ææ–™
- âœ… éæ­£å¼æŠ€æœ¯æ–‡æ¡£
- âœ… éœ€è¦å¢åŠ äº²å’ŒåŠ›çš„å›¾è¡¨

### ä¸é€‚åˆåœºæ™¯
- âŒ æ­£å¼æŠ€æœ¯æ–‡æ¡£ï¼ˆéœ€è¦ç²¾ç¡®çº¿æ¡ï¼‰
- âŒ éœ€è¦é«˜ç²¾åº¦å›¾è¡¨çš„åœºåˆ

---

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ 1: å›¾ç‰‡ç”Ÿæˆå¤±è´¥
**æ£€æŸ¥**:
- ç¡®ä¿å·²å®‰è£… `roughjs`ã€`sharp`ã€`jsdom`
- æ£€æŸ¥ mermaid-cli æ˜¯å¦æ”¯æŒ SVG è¾“å‡º

### é—®é¢˜ 2: æ•ˆæœä¸æ˜æ˜¾
**è§£å†³**:
- å¢åŠ  `roughness` å‚æ•°ï¼ˆå¦‚ 2.0ï¼‰
- å°è¯•ä¸åŒçš„ `fillStyle`

### é—®é¢˜ 3: æ–‡ä»¶å¤§å°è¿‡å¤§
**è§£å†³**:
- è°ƒæ•´ `scale` å‚æ•°
- ä½¿ç”¨ JPG æ ¼å¼ï¼ˆå¦‚æœæ”¯æŒï¼‰

---

## ğŸ“ ç¤ºä¾‹ä»£ç 

### å®Œæ•´ç¤ºä¾‹

```typescript
import { convertMermaid } from "./src/mermaid/renderer.js";

// å¯ç”¨æ‰‹ç»˜é£æ ¼
const result = await convertMermaid({
  filePath: "article.md",
  format: "png",
  scale: 1.5,
  handDrawn: {
    enabled: true,
    roughness: 1.5,
    fillStyle: "hachure",
  },
});

console.log(`ç”Ÿæˆäº† ${result.images.length} ä¸ªæ‰‹ç»˜é£æ ¼å›¾è¡¨`);
```

---

## ğŸ‰ æ€»ç»“

æ‰‹ç»˜é£æ ¼åŠŸèƒ½å·²å®Œå…¨å®ç°å¹¶æµ‹è¯•é€šè¿‡ï¼

- âœ… **å®ç°å®Œæˆ**: Rough.js + SVG æ–¹æ¡ˆ
- âœ… **æµ‹è¯•é€šè¿‡**: 3 ä¸ªå›¾è¡¨æˆåŠŸè½¬æ¢
- âœ… **æ•ˆæœè‰¯å¥½**: æ¥è¿‘ Excalidraw é£æ ¼
- âœ… **å¯é…ç½®**: æ”¯æŒ roughness å’Œ fillStyle è°ƒæ•´

**ç°åœ¨å¯ä»¥å¼€å§‹ä½¿ç”¨æ‰‹ç»˜é£æ ¼åŠŸèƒ½äº†ï¼** ğŸ¨

